<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEM ë¹„êµ ë·°ì–´</title>

    <script>
        window.CESIUM_BASE_URL = '../Build/Cesium/';
    </script>

    <script src="../Build/Cesium/Cesium.js"></script>
    <link href="../Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">

    <style>
        /* DEM ë¹„êµ ì „ìš© ìŠ¤íƒ€ì¼ */
        #terrain-controls {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            min-width: 280px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        #terrain-controls h3 {
            margin: 0 0 15px 0;
            font-size: 18px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .terrain-section {
            margin-bottom: 20px;
        }

        .terrain-section h4 {
            margin: 0 0 10px 0;
            font-size: 13px;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .terrain-btn {
            display: block;
            width: 100%;
            padding: 12px 15px;
            margin: 8px 0;
            border: 2px solid #444;
            border-radius: 8px;
            background: #2a2a2a;
            color: white;
            cursor: pointer;
            font-size: 14px;
            text-align: left;
            transition: all 0.3s;
        }

        .terrain-btn:hover {
            background: #3a3a3a;
            border-color: #666;
        }

        .terrain-btn.active {
            border-color: #4CAF50;
            background: linear-gradient(135deg, #1b5e20, #2e7d32);
        }

        .terrain-btn .btn-title {
            font-weight: 600;
            display: block;
        }

        .terrain-btn .btn-desc {
            font-size: 11px;
            color: #aaa;
            margin-top: 3px;
        }

        #btn-original {
            border-left: 4px solid #FF6B6B;
        }

        #btn-generated {
            border-left: 4px solid #4ECDC4;
        }

        #terrain-status {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            font-size: 13px;
            text-align: center;
            border-left: 3px solid #4CAF50;
        }

        /* ì¹´ë©”ë¼ ë²„íŠ¼ */
        .camera-btn {
            display: inline-block;
            padding: 8px 12px;
            margin: 3px;
            background: #333;
            border: 1px solid #555;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .camera-btn:hover {
            background: #444;
            border-color: #2196F3;
        }

        /* ìŠ¬ë¼ì´ë” */
        .slider-container {
            margin-top: 10px;
        }

        .slider-container label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
        }

        .slider-container input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #444;
            outline: none;
            -webkit-appearance: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
        }

        #exaggeration-label {
            float: right;
            color: #4CAF50;
            font-weight: bold;
        }

        /* ì •ë³´ íŒ¨ë„ */
        #dem-info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 15px;
            border-radius: 8px;
            z-index: 999;
            font-size: 12px;
            min-width: 200px;
        }

        #dem-info .info-row {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }

        #dem-info .info-label {
            color: #aaa;
        }

        #dem-info .info-value {
            color: #4CAF50;
            font-weight: bold;
        }

        /* ë²”ë¡€ */
        .legend {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #444;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            font-size: 12px;
        }

        .legend-color {
            width: 20px;
            height: 12px;
            margin-right: 10px;
            border-radius: 2px;
        }
    </style>
</head>

<body>
    <div id="cesiumContainer"></div>

    <!-- DEM ë¹„êµ ì»¨íŠ¸ë¡¤ -->
    <div id="terrain-controls">
        <h3>ğŸ”ï¸ DEM ë¹„êµ ë·°ì–´</h3>

        <div class="terrain-section">
            <h4>ì§€í˜• ì„ íƒ</h4>
            <button id="btn-original" class="terrain-btn active" onclick="switchTerrain('original')">
                <span class="btn-title">ğŸ“¦ ì›ë³¸ DEM</span>
                <span class="btn-desc">gumi_dem.tif - ì›ë³¸ ìˆ˜ì¹˜í‘œê³ ëª¨ë¸</span>
            </button>
            <button id="btn-generated" class="terrain-btn" onclick="switchTerrain('generated')">
                <span class="btn-title">ğŸ¤– ìƒì„± DEM</span>
                <span class="btn-desc">gumi_gen_dem.tif - AI ìƒì„± ëª¨ë¸</span>
            </button>
        </div>

        <div id="terrain-status">âœ… ì›ë³¸ DEM ì ìš©ë¨</div>

        <div class="terrain-section">
            <h4>ì¹´ë©”ë¼ í”„ë¦¬ì…‹</h4>
            <button class="camera-btn" onclick="flyToGumi()">ğŸŒ ì „ì²´</button>
            <button class="camera-btn" onclick="flyToGumiClose()">ğŸ” ê·¼ì ‘</button>
            <button class="camera-btn" onclick="flyToGumiSide()">ğŸ“ ì¸¡ë©´</button>
            <button class="camera-btn" onclick="resetCamera()">ğŸ¯ ë¦¬ì…‹</button>
        </div>

        <div class="terrain-section">
            <h4>ì§€í˜• ê³¼ì¥</h4>
            <div class="slider-container">
                <label>
                    ë†’ì´ ë°°ìœ¨ <span id="exaggeration-label">1.0x</span>
                </label>
                <input type="range" min="1" max="5" step="0.5" value="1" onchange="setTerrainExaggeration(this.value)">
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #FF6B6B;"></div>
                <span>ì›ë³¸ DEM (8091)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #4ECDC4;"></div>
                <span>ìƒì„± DEM (8092)</span>
            </div>
        </div>
    </div>

    <!-- ì •ë³´ íŒ¨ë„ -->
    <div id="dem-info">
        <h4 style="margin: 0 0 10px 0; color: #2196F3;">ğŸ“Š ì¹´ë©”ë¼ ì •ë³´</h4>
        <div class="info-row">
            <span class="info-label">ê³ ë„:</span>
            <span class="info-value" id="camera-height">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">ìœ„ë„:</span>
            <span class="info-value" id="camera-lat">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">ê²½ë„:</span>
            <span class="info-value" id="camera-lon">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">í˜„ì¬ ì§€í˜•:</span>
            <span class="info-value" id="current-terrain">ì›ë³¸</span>
        </div>
    </div>

    <!-- ë„ì›€ë§ ë²„íŠ¼ -->
    <button id="help-button" onclick="toggleHelp()" title="ë„ì›€ë§">?</button>

    <!-- ë„ì›€ë§ ëª¨ë‹¬ -->
    <div id="help-modal" class="help-modal">
        <button class="close-button" onclick="toggleHelp()">Ã—</button>
        <h2>ğŸ”ï¸ DEM ë¹„êµ ë·°ì–´</h2>

        <h3>ì‚¬ìš© ë°©ë²•</h3>
        <ul>
            <li><strong>ì›ë³¸ DEM</strong>: gumi_dem.tif (ì›ë³¸ ìˆ˜ì¹˜í‘œê³ ëª¨ë¸)</li>
            <li><strong>ìƒì„± DEM</strong>: gumi_gen_dem.tif (AIê°€ ìƒì„±í•œ ëª¨ë¸)</li>
            <li>ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë‘ ì§€í˜•ì„ ì „í™˜í•˜ë©° ë¹„êµ</li>
        </ul>

        <h3>ë§ˆìš°ìŠ¤ ì¡°ì‘</h3>
        <ul>
            <li>ì™¼ìª½ ë“œë˜ê·¸: ì§€ë„ ì´ë™</li>
            <li>ì˜¤ë¥¸ìª½ ë“œë˜ê·¸: íšŒì „</li>
            <li>Shift + ì™¼ìª½ ë“œë˜ê·¸: ê¸°ìš¸ê¸°</li>
            <li>ë§ˆìš°ìŠ¤ íœ : ì¤Œ ì¸/ì•„ì›ƒ</li>
        </ul>

        <h3>ì§€í˜• ê³¼ì¥</h3>
        <ul>
            <li>ìŠ¬ë¼ì´ë”ë¡œ ë†’ì´ ë°°ìœ¨ ì¡°ì • (1x ~ 5x)</li>
            <li>ë¯¸ì„¸í•œ ì§€í˜• ì°¨ì´ë¥¼ ë” ì‰½ê²Œ í™•ì¸ ê°€ëŠ¥</li>
        </ul>

        <h3>ì½˜ì†” ëª…ë ¹ì–´</h3>
        <ul>
            <li><code>switchTerrain('original')</code> - ì›ë³¸</li>
            <li><code>switchTerrain('generated')</code> - ìƒì„±</li>
            <li><code>setTerrainExaggeration(3)</code> - ë†’ì´ 3ë°°</li>
        </ul>
    </div>

    <script src="main.js"></script>

    <script>
        // ë„ì›€ë§ í† ê¸€
        function toggleHelp() {
            const modal = document.getElementById('help-modal');
            modal.style.display = modal.style.display === 'block' ? 'none' : 'block';
        }

        // ì•Œë¦¼ í•¨ìˆ˜
        window.showNotification = function (message, type = 'info') {
            console.log(`[${type}] ${message}`);

            const colors = {
                info: '#2196F3',
                success: '#4CAF50',
                warning: '#FF9800',
                error: '#F44336'
            };

            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type] || colors.info};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                z-index: 10000;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                font-family: 'Segoe UI', sans-serif;
                font-size: 14px;
                max-width: 300px;
                animation: slideIn 0.3s ease-out;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.5s';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        };

        // ì¹´ë©”ë¼ ì •ë³´ ì—…ë°ì´íŠ¸
        if (typeof viewer !== 'undefined') {
            viewer.camera.changed.addEventListener(function () {
                const pos = viewer.camera.positionCartographic;
                const height = Math.round(pos.height);
                const lat = Cesium.Math.toDegrees(pos.latitude).toFixed(5);
                const lon = Cesium.Math.toDegrees(pos.longitude).toFixed(5);

                document.getElementById('camera-height').textContent = height.toLocaleString() + 'm';
                document.getElementById('camera-lat').textContent = lat + 'Â°';
                document.getElementById('camera-lon').textContent = lon + 'Â°';
            });
        }

        // ì§€í˜• ì „í™˜ ì‹œ ì •ë³´ ì—…ë°ì´íŠ¸
        const originalSwitchTerrain = window.switchTerrain;
        window.switchTerrain = async function (key) {
            await originalSwitchTerrain(key);
            const names = { original: 'ì›ë³¸', generated: 'ìƒì„±' };
            document.getElementById('current-terrain').textContent = names[key] || key;
        };
    </script>
</body>

</html>